= The Blacklight demo app

This is documentation for the blacklight demo application. Blacklight comes distributed as a rails engines plugin and as a demo application that implements that plugin. A typical use case is to install the demo application, customize it, and then upgrade the enclosed plugin as needed in order to take advantage of bug fixes and new functionality, while still maintaining your local customizations. Documentation like this is generated by running 'rake rdoc' against a Rakefile and a DEMO_README file, and it is recommended that you use this rdoc system as a way of documenting your local customizations too.

See:  vendor/plugins/blacklight for more detailed info about the plugin itself. 

= Installation instructions for the demo application

June 25, 2009
release 2.2

== Be sure to install the {pre-requisites}[link:files/vendor/plugins/blacklight/PRE-REQUISITES_rdoc.html] first

The demo app comes with Solr and the Jetty application server embedded. But be sure you have a Java version installed recent enough to meet the {Solr requirements}[link:http://wiki.apache.org/solr/FAQ#head-d0235ca79aa77fd73507d37b82462abd2a848a46].  We recommend using a Sun JRE. 

== Installation of the demo app
		
===Checkout and setup the demo application

====Checkout a copy of the demo app (which comes with the blacklight plugin pre-installed). 
You have a couple of choices here. You can either download a release from rubyforge here: http://rubyforge.org/projects/blacklight/, or if you're feeling cutting-edge, you can check out from subversion:
* Anonymously:
		svn co http://blacklight.rubyforge.org/svn/trunk/ bl-demo
* If you have commit rights:
		svn co svn+ssh://username@rubyforge.org/var/svn/blacklight/trunk/ bl-demo

====Move into the rails dir:
	cd bl-demo/rails

====Copy the database and other configuration files:
	cp config/database.example config/database.yml
	cp config/solr.example config/solr.yml
	cp vendor/plugins/blacklight/config/initializers/blacklight_config.rb ./config/initializers/
	
====Setup your database (for storing user accounts and bookmarks)

The default database settings are configured to use sqlite3. If you want to use mysql instead, create a database called blacklight_development:

	mysqladmin create blacklight_development # your command will vary

Then put this into your config/database.yml file instead of the default settings: 

	development:
		adapter: mysql
		database: blacklight_demo_development
		username: demo
		password: *****
		host: localhost
		socket: /opt/local/var/run/mysql5/mysqld.sock

Regardless of which database you're using, you'll need to run the database migrations:
	
	rake db:migrate

====Possible Issues with Gems
Some installation sites have reported difficulties with gems at installation time.  There is a section about this in {README.rdoc}[link:files/vendor/plugins/blacklight/README_rdoc.html]
	
====Start Solr

Now start Solr via Jetty. Change into the bl-demo/jetty directory:

	cd ../jetty
	java -jar start.jar

You should see a bunch of logging and should stop after a few seconds. Solr should now be running and you can test it by browsing to:
	http://localhost:8983/solr

====Index the test data
Now open a new terminal window and move into the rails dir again:
	cd bl-demo/rails
And kick off the rake task to index some test data:
	rake solr:marc:index MARC_FILE=../data/test_data.utf8.mrc
You should see all of the records being indexed.
Look at the Jetty terminal window, verify that Solr is receiving the data -- there should be lots of logging activity.
After it is finished, check http://localhost:8983/solr/admin/stats.jsp. In the "CORE" section, numDocs should not be 0.

You can also index some test EAD files:
  rake app:index:ead_dir FILE=../data/ead/*.xml

====Start Rails

When the indexing is done, fire up Rails:

	ruby ./script/server

Browse to:
	http://localhost:3000/

====(optional) Index more data
Once you have the basic application working, you can index more data. The command is the same, just point at a different data file, for example:
	rake solr:marc:index MARC_FILE=../data/lc_records.utf8.mrc
  
That rake task indexes your data with SolrMarc, a java app included in the demo distribution.  If you're interested in seeing what it's doing, just add ":info" on the end of the task, and it will tell you about the action it would perform, but not perform it (a 'dry run'). 
  rake solr:marc:index:info MARC_FILE=../data/lc_records.utf8.mrc
  
You can download more sample sets here: http://www.archive.org/search.php?query=mediatype%3A%22data%22%20MARC	
You could also point it at a set of exported MaRC records from your own library. 

If you want to extensively change how the indexing assigns Marc data to Solr fields, we recommend a starting point of the GenericBlacklight example code from the SolrMarc project.  See http://code.google.com/p/solrmarc/.  There are helpful wikis there.

NOTE:  the indexing code provided with the Blacklight project is the GenericBlacklight example in the SolrMarc project.
